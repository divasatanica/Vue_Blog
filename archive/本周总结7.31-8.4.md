## 导语

本周跨越了两个月，实在是又热又湿又不舒服，周三出门下大雨鞋子湿了一天别提多难受。说说这周的工作总结吧。这周大部分都是重复性的工作，都是解决各种在debug过程中给自己挖的另外的坑，这种工作做多了容易疲劳，不如那种需要创造的编码来得有趣，但是一想，其实日后的正式工作更多的是维护自己亦或者是别人做的项目，创造的话可能会比较少吧。

## 技术方面

因为更多的是debug所以可能这部分会比较少

### 1.CSS方面的一些基础

__绝对定位。__就我个人而言，不是特别极端的布局需求一般不会用，因为这种脱离了文档流的东西，虽说自由了没有束缚了，但正因为这一点，绝对定位的元素比较难控制，在窗口发生变化的时候，如果使用的单位是像素那么基本上就会GG了，像现在在做的项目就是，一个模态框的关闭按钮因为是绝对定位的，然后窗口宽度变小的时候直接挡住看不到，就是一个死的元素。原谅我css一直很差，之前一直以为绝对定位就是相对整个页面来定位的，没想到是以最近一层相对定位的容器来定位的，知道了这一点，我对绝对定位难控制的印象好一点了，但是还是觉得少用一点比较好，样式要照着骨架来添加。

__背景Background属性。__平时自己写样式都是走冷漠简约的风格，所以基本上都只用一个background-color搞定/捂脸，这几天在重构一个组件的样式(之前不是我写的样式)，用到background复合属性的各个子属性，比如这样：

```css
.element {
  background: #E04900 url('../../xx.png') no-repeat 100px 15px;
  background-size: 20px 20px;
}
```
第一条前两个是背景颜色和背景图片，顾名思义了，这两个可以一起用，按照实际效果来看，设置了no-repeat的背景图可能不会铺满整个元素，那么剩余的部分就由背景颜色来填充，no-repeat表示不平铺，如果不设置这项属性，图片将会铺满整个元素。后面两项则是背景距离元素左边和顶部的距离。

第二条background-size可以用来缩放背景，像上面那样就是直接设置宽高，会导致背景图变形，此外还有三种预设选项，percentage-按照百分比设置宽高，contain-保持原图比例将背景放到最大，cover-直接将图放到最大使背景完全覆盖元素，有些部分可能会显示不了。

__BFC(Block Format Context)__ 讲真这个我看了很多次网上讲解的文章都没看懂，要补补css权威指南了(对，就是那本咸鱼封面的书)。这里放个链接我自己马着，一定要搞懂。

[什么是BFC](http://web.jobbole.com/84808/)

之前在做组件样式的时候出现了一个问题，一个父容器的第一个子元素，给这个子元素设置margin-top但是没有把边距撑开，后来给父容器加上```position: absolute```属性之后就可以了，之前看的文章是说设置了给父容器绝对定位之后，就在子元素之间产生了BFC从而隔绝了相互margin的影响，变为不会在垂直方向折叠。具体是怎样，待我看懂BFC再细说吧。

### 2.关于node的单线程异步模型

node运行时使用单线程来处理数据，服务端程序阻塞的原因主要在IO上，例如文件的读写，数据库的连接、查询和返回数据等等，如果因为IO阻塞下一步的处理，那么对于单线程的程序来说无疑是致命的，效率将变得十分低下。于是node采用了单线程异步模型，将对IO的处理放在回调函数里，等于是node把一件件事件排进各自的IO处理队列中，让其他的进程来处理这些IO，处理完毕之后通过回调函数再交由node来进行下一步操作(这称为事件驱动)，那么期间可以说node总是有空闲来接收下一个请求，因为它接收请求之后就让各IO事件到其他线程中排队，从而提高了node线程本身处理各个事件的能力。当时我看完相关文章，心想node底层实现还是用多线程嘛，只不过中央处理事件的node线程只有一个。

实习入职第一天在回公司的路上跟导师聊天讲到node做后台的问题，导师说到其实现在虽说node让javascript可以在服务端运行，但是大部分后台程序还是由java来实现和运行，node的话可以作为一个中间层来使用。当时我没怎么听明白，说到了数据转发，格式化数据之类的功能，但我不太理解这个中间层存在的意义。我在想可不可以理解成一个中间件，就是类似于一站式服务的意思，中间件把原始的数据全部按照标准打包好，然后中间件的用户只管取出数据而无需做处理，可以理解成供应商-代理商-采购商三者之间的关系。这个还需要去看看文章。

### 3.关于node在Linux系统上的部署

查阅资料发现大部分方案是nginx做反向代理，pm2做进程守护。唔，nginx是个web server软件，支持高并发，负载均衡，代理静态文件等一系列功能，具体更深入的我还不了解，目前只是做反向代理使用，类似的有apache、IIS。不得不说之前在apache上面部署flask真的搞得我要死，核心文件连Google都找不到，最后都忘了在哪个野鸡云盘里面下载到了。

今天刚搞完nginx的反向代理，搞了一中午总算是能用，总得来说就是监听某个端口(通常是80端口),然后将所有从这个端口进来的流量转发到对应端口上。看到配置里面有个upstream选项，查看之后发现是作负载均衡用的，我有个想法，可不可以在服务器上面开多个进程监听端口，然后nginx将流量均衡到各个端口上面去，pm2应该可以用来做这个，一个node的线程池。具体的将来真正部署再研究吧。

## 软技术

周三团队开会，一开始我们自认为做得还差不多，但是老大一拿到手就指出了很多缺点，而且我发现很多不是实现原理的问题，不是你这里代码性能不好，那里容易崩溃，而是最表面的，你这个UI让用户很懵逼，很难用，很容易误导！对此我深感做前端不光要研究技术去实现各种界面和逻辑功能，更重要的是，要用技术让你的界面对用户友好，引导用户去使用你的技术，使用你的产品，这个也是很重要的一点。

开完会第二天开始改代码，之前我负责的组件的样式不是我写的，但是现在需要我来改，基本等于是重构，一大堆很难快速理清思路，而且每个人的书写习惯大相径庭，有时候很难理解对方这样写的目的。不禁感叹一个团队代码规范和注释习惯真的太重要了，这不仅有利于组员之间相互交流，还有利于debug和接手开发/捂脸像我单打独斗惯了就不爱写注释，以后一定要改正这个毛病。

## 结语

这周过得很快，因为每天都在不停地改代码，不知不觉来了快20天了，学到的不仅有硬技术也有软技术，对自己是各方面的提高。

继续努力。
